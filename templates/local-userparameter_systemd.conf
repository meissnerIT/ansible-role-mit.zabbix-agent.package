# Managed by ansible (mit.zabbix-agent.package)
# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN

# Deprecated, replaced by systemd.timesyncd-ntp-synchronized
UserParameter=system.systemd-timesyncd-ntp-synchronized,timedatectl status 2>&1|egrep "(NTP|System clock) synchronized:" | awk '{print $NF;}'

# https://www.zabbix.com/documentation/5.0/manual/config/items/itemtypes/zabbix_agent/zabbix_agent2
# simulate Zabbix Agent 2
{% if 'dbus' in ansible_facts.packages %}
UserParameter=systemd.unit.info[*],/usr/bin/systemctl is-active $1
{% else %}
UserParameter=systemd.unit.info[*],sudo /usr/bin/systemctl is-active $1
{% endif %}
UserParameter=systemd.timesyncd-ntp-synchronized,timedatectl status 2>&1|egrep "(NTP|System clock) synchronized:" | awk '{print $NF;}'

# Unified status for services on Linux and FreeBSD
{% if 'dbus' in ansible_facts.packages %}
UserParameter=service.status[*],/usr/bin/systemctl is-active $1|egrep -c "^active"
{% else %}
UserParameter=service.status[*],sudo /usr/bin/systemctl is-active $1|egrep -c "^active"
{% endif %}

