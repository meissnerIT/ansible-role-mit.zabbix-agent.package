#!/usr/bin/env python3
#
# Managed by ansible ({{ ansible_role_name }})
# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
#
# markus.meissner@meissner.IT
#
# - 2025-03-18: Initial release

import json
import subprocess

data = list()

services = subprocess.run(
    ["systemctl", "list-units", "--type=service", "--plain", "--quiet"],
    capture_output=True,
    text=True,
)
for service in services.stdout.splitlines():
    if ".service" in service:
        data.append({"{#UNIT.NAME}": service.split(" ")[0]})
print(json.dumps({"data": data}, indent=4))
